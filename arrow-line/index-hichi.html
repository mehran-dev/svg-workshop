<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SVG Line Drawer</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        background-color: #f0f0f0;
      }
      svg {
        border: 1px solid #ccc;
        cursor: crosshair;
      }
      button {
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <svg id="svgCanvas" width="800" height="600"></svg>
    <button id="toggleButton">Toggle Arrow State</button>

    <script>
      const svgCanvas = document.getElementById("svgCanvas");
      const toggleButton = document.getElementById("toggleButton");

      let points = [];
      let currentState = 0; // 0: None, 1: Right, 2: Left, 3: Both

      svgCanvas.addEventListener("click", (event) => {
        const rect = svgCanvas.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;

        if (points.length < 2) {
          points.push({ x, y });
          if (points.length === 2) {
            drawLine();
          }
        }
      });

      toggleButton.addEventListener("click", () => {
        currentState = (currentState + 1) % 4; // Cycle through the states
        drawLine();
      });

      function drawLine() {
        svgCanvas.innerHTML = ""; // Clear the canvas

        if (points.length === 2) {
          const { x: x1, y: y1 } = points[0];
          const { x: x2, y: y2 } = points[1];

          // Draw the line
          const line = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "line"
          );
          line.setAttribute("x1", x1);
          line.setAttribute("y1", y1);
          line.setAttribute("x2", x2);
          line.setAttribute("y2", y2);
          line.setAttribute("stroke", "black");
          line.setAttribute("stroke-width", 2);
          svgCanvas.appendChild(line);

          // Calculate the direction
          const dx = x2 - x1;
          const dy = y2 - y1;
          const angle = Math.atan2(dy, dx);
          const length = Math.sqrt(dx * dx + dy * dy);
          const arrowHeight = 10; // Height of the triangle
          const baseWidth = 6; // Base width of the triangle

          // Draw arrows based on the current state
          if (currentState === 1 || currentState === 3) {
            // Right arrow
            drawArrow(x2, y2, angle, arrowHeight, baseWidth);
          }
          if (currentState === 2 || currentState === 3) {
            // Left arrow
            drawArrow(x1, y1, angle + Math.PI, arrowHeight, baseWidth);
          }
        }
      }

      function drawArrow(x, y, angle, height, baseWidth) {
        const path = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "polygon"
        );
        const x1 = x + Math.cos(angle) * height;
        const y1 = y + Math.sin(angle) * height;
        const x2 = x + Math.cos(angle - Math.PI / 6) * baseWidth;
        const y2 = y + Math.sin(angle - Math.PI / 6) * baseWidth;
        const x3 = x + Math.cos(angle + Math.PI / 6) * baseWidth;
        const y3 = y + Math.sin(angle + Math.PI / 6) * baseWidth;
        path.setAttribute("points", `${x1},${y1} ${x2},${y2} ${x3},${y3}`);
        path.setAttribute("fill", "black");
        svgCanvas.appendChild(path);
      }
    </script>
  </body>
</html>
